/*! ExcelJS 28-04-2017 */
"use strict";var events=require("events"),Sax=require("sax"),utils=require("../../utils/utils"),Enums=require("../../doc/enums"),RelType=require("../../xlsx/rel-type"),HyperlinkReader=module.exports=function(a,b){this.id=b,this._workbook=a};utils.inherits(HyperlinkReader,events.EventEmitter,{get count(){return this.hyperlinks&&this.hyperlinks.length||0},each:function(a){return this.hyperlinks.forEach(a)},read:function(a,b){var c=this,d=!1,e=null;switch(b.hyperlinks){case"emit":d=!0;break;case"cache":this.hyperlinks=e={}}if(!d&&!e)return void a.autodrain();var f=Sax.createStream(!0,{});f.on("opentag",function(a){if("Relationship"===a.name){var b=a.attributes.Id;switch(a.attributes.Type){case RelType.Hyperlink:var f={type:Enums.RelationshipType.Styles,rId:b,target:a.attributes.Target,targetMode:a.attributes.TargetMode};d?c.emit("hyperlink",f):e[f.rId]=f}}}),f.on("end",function(){c.emit("finished")});var g=this.workbook.flowControl.createChild();g.pipe(f,{sync:!0}),a.pipe(g)}});