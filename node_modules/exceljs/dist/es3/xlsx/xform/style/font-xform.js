/*! ExcelJS 28-04-2017 */
"use strict";var ColorXform=require("./color-xform"),BooleanXform=require("../simple/boolean-xform"),IntegerXform=require("../simple/integer-xform"),StringXform=require("../simple/string-xform"),UnderlineXform=require("./underline-xform"),_=require("../../../utils/under-dash"),utils=require("../../../utils/utils"),BaseXform=require("../base-xform"),FontXform=module.exports=function(a){this.options=a||FontXform.OPTIONS,this.map={b:{prop:"bold",xform:new BooleanXform({tag:"b",attr:"val"})},i:{prop:"italic",xform:new BooleanXform({tag:"i",attr:"val"})},u:{prop:"underline",xform:new UnderlineXform},charset:{prop:"charset",xform:new IntegerXform({tag:"charset",attr:"val"})},color:{prop:"color",xform:new ColorXform},condense:{prop:"condense",xform:new BooleanXform({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new BooleanXform({tag:"extend",attr:"val"})},family:{prop:"family",xform:new IntegerXform({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new BooleanXform({tag:"outline",attr:"val"})},scheme:{prop:"scheme",xform:new StringXform({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new BooleanXform({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new BooleanXform({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new IntegerXform({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new StringXform({tag:this.options.fontNameTag,attr:"val"})}};FontXform.OPTIONS={tagName:"font",fontNameTag:"name"},utils.inherits(FontXform,BaseXform,{get tag(){return this.options.tagName},render:function(a,b){var c=this.map;a.openNode(this.options.tagName),_.each(this.map,function(d,e){c[e].xform.render(a,b[d.prop])}),a.closeNode()},parseOpen:function(a){if(this.parser)return this.parser.parseOpen(a),!0;if(this.map[a.name])return this.parser=this.map[a.name].xform,this.parser.parseOpen(a);switch(a.name){case this.options.tagName:return this.model={},!0;default:return!1}},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){if(this.parser&&!this.parser.parseClose(a)){var b=this.map[a];return this.parser.model&&(this.model[b.prop]=this.parser.model),this.parser=void 0,!0}switch(a){case this.options.tagName:return!1;default:return!0}}});