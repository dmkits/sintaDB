/*! ExcelJS 28-04-2017 */
"use strict";var utils=require("../../../utils/utils"),BaseXform=require("../base-xform"),AlignmentXform=require("./alignment-xform"),StyleXform=module.exports=function(a){this.xfId=!(!a||!a.xfId),this.map={alignment:new AlignmentXform}};utils.inherits(StyleXform,BaseXform,{get tag(){return"xf"},render:function(a,b){a.openNode("xf",{numFmtId:b.numFmtId||0,fontId:b.fontId||0,fillId:b.fillId||0,borderId:b.borderId||0}),this.xfId&&a.addAttribute("xfId",b.xfId||0),b.numFmtId&&a.addAttribute("applyNumberFormat","1"),b.fontId&&a.addAttribute("applyFont","1"),b.fillId&&a.addAttribute("applyFill","1"),b.borderId&&a.addAttribute("applyBorder","1"),b.alignment&&(a.addAttribute("applyAlignment","1"),this.map.alignment.render(a,b.alignment)),a.closeNode()},parseOpen:function(a){if(this.parser)return this.parser.parseOpen(a),!0;switch(a.name){case"xf":return this.model={numFmtId:parseInt(a.attributes.numFmtId,10),fontId:parseInt(a.attributes.fontId,10),fillId:parseInt(a.attributes.fillId,10),borderId:parseInt(a.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(a.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(a),!0;default:return!1}},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){return this.parser?(this.parser.parseClose(a)||(this.model.alignment=this.parser.model,this.parser=void 0),!0):"xf"!==a}});