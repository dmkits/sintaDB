/*! ExcelJS 28-04-2017 */
"use strict";var utils=require("../../../utils/utils"),BaseXform=require("../base-xform"),ColorXform=require("./color-xform"),EdgeXform=function(a){this.name=a,this.map={color:new ColorXform}};utils.inherits(EdgeXform,BaseXform,{get tag(){return this.name},render:function(a,b,c){var d=b&&b.color||c||this.defaultColor;a.openNode(this.name),b&&b.style&&(a.addAttribute("style",b.style),d&&this.map.color.render(a,d)),a.closeNode()},parseOpen:function(a){if(this.parser)return this.parser.parseOpen(a),!0;switch(a.name){case this.name:var b=a.attributes.style;return this.model=b?{style:b}:void 0,!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(a),!0;default:return!1}},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){return this.parser?(this.parser.parseClose(a)||(this.parser=void 0),!0):(a===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)},validStyleValues:["thin","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce(function(a,b){return a[b]=!0,a},{}),validStyle:function(a){return this.validStyleValues[a]}});var BorderXform=module.exports=function(){this.map={top:new EdgeXform("top"),left:new EdgeXform("left"),bottom:new EdgeXform("bottom"),right:new EdgeXform("right"),diagonal:new EdgeXform("diagonal")}};utils.inherits(BorderXform,BaseXform,{render:function(a,b){function c(c,e){c&&!c.color&&b.color&&(c=Object.assign({},c,{color:b.color})),e.render(a,c,d)}var d=b.color;a.openNode("border"),b.diagonal&&b.diagonal.style&&(b.diagonal.up&&a.addAttribute("diagonalUp","1"),b.diagonal.down&&a.addAttribute("diagonalDown","1")),c(b.left,this.map.left),c(b.right,this.map.right),c(b.top,this.map.top),c(b.bottom,this.map.bottom),c(b.diagonal,this.map.diagonal),a.closeNode()},parseOpen:function(a){if(this.parser)this.parser.parseOpen(a);else switch(a.name){case"border":return this.diagonalUp=!!a.attributes.diagonalUp,this.diagonalDown=!!a.attributes.diagonalDown,this.map.left.reset(),this.map.right.reset(),this.map.top.reset(),this.map.bottom.reset(),this.map.diagonal.reset(),!0;default:return this.parser=this.map[a.name],!!this.parser&&(this.parser.parseOpen(a),!0)}},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){if(this.parser)return this.parser.parseClose(a)||(this.parser=void 0),!0;if("border"===a){var b=this.model={},c=function(a,c,d){c&&(d&&Object.assign(c,d),b[a]=c)};c("left",this.map.left.model),c("right",this.map.right.model),c("top",this.map.top.model),c("bottom",this.map.bottom.model),c("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}});