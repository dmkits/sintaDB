/*! ExcelJS 28-04-2017 */
"use strict";var Enums=require("../../../doc/enums"),utils=require("../../../utils/utils"),BaseXform=require("../base-xform"),validation={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce(function(a,b){return a[b]=!0,a},{}),horizontal:function(a){return this.horizontalValues[a]?a:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce(function(a,b){return a[b]=!0,a},{}),vertical:function(a){return"middle"===a?"center":this.verticalValues[a]?a:void 0},wrapText:function(a){return!!a||void 0},shrinkToFit:function(a){return!!a||void 0},textRotation:function(a){switch(a){case"vertical":return a;default:return a=utils.validInt(a),a>=-90&&a<=90?a:void 0}},indent:function(a){return a=utils.validInt(a),Math.max(0,a)},readingOrderValues:[{k:"r2l",v:1},{k:"l2r",v:2},{k:Enums.ReadingOrder.RightToLeft,v:1},{k:Enums.ReadingOrder.LeftToRight,v:2}].reduce(function(a,b){return a[b.k]=b.v,a},{}),readingOrder:function(a){return this.readingOrderValues[a]}},textRotationXform={toXml:function(a){if(a=validation.textRotation(a)){if("vertical"===a)return 255;var b=Math.round(a);if(b>=0&&b<=90)return b;if(b<0&&b>=-90)return 90-b}},toModel:function(a){var b=utils.validInt(a);if(void 0!==b){if(255===b)return"vertical";if(b>=0&&b<=90)return b;if(b>90&&b<=180)return 90-b}}},AlignmentXform=module.exports=function(){};utils.inherits(AlignmentXform,BaseXform,{get tag(){return"alignment"},render:function(a,b){function c(b,c){c&&(a.addAttribute(b,c),d=!0)}a.addRollback(),a.openNode("alignment");var d=!1;c("horizontal",validation.horizontal(b.horizontal)),c("vertical",validation.vertical(b.vertical)),c("wrapText",!!validation.wrapText(b.wrapText)&&"1"),c("shrinkToFit",!!validation.shrinkToFit(b.shrinkToFit)&&"1"),c("indent",validation.indent(b.indent)),c("textRotation",textRotationXform.toXml(b.textRotation)),c("readingOrder",validation.readingOrder(b.readingOrder)),a.closeNode(),d?a.commit():a.rollback()},parseOpen:function(a){function b(a,b,e){a&&(c[b]=e,d=!0)}var c={},d=!1;b(a.attributes.horizontal,"horizontal",a.attributes.horizontal),b(a.attributes.vertical,"vertical","center"===a.attributes.vertical?"middle":a.attributes.vertical),b(a.attributes.wrapText,"wrapText",!!a.attributes.wrapText),b(a.attributes.shrinkToFit,"shrinkToFit",!!a.attributes.shrinkToFit),b(a.attributes.indent,"indent",parseInt(a.attributes.indent,10)),b(a.attributes.textRotation,"textRotation",textRotationXform.toModel(a.attributes.textRotation)),b(a.attributes.readingOrder,"readingOrder",a.attributes.readingOrder),this.model=d?c:null},parseText:function(){},parseClose:function(){return!1}});