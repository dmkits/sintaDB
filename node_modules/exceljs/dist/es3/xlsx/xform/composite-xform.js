/*! ExcelJS 28-04-2017 */
"use strict";var utils=require("../../utils/utils"),BaseXform=require("./base-xform"),CompositeXform=module.exports=function(a){this.tag=a.tag,this.attrs=a.attrs,this.children=a.children,this.map=this.children.reduce(function(a,b){var c=b.name||b.tag,d=b.tag||b.name;return a[d]=b,b.name=c,b.tag=d,a},{})};utils.inherits(CompositeXform,BaseXform,{prepare:function(a,b){this.children.forEach(function(c){c.xform.prepare(a[c.tag],b)})},render:function(a,b){a.openNode(this.tag,this.attrs),this.children.forEach(function(c){c.xform.render(a,b[c.name])}),a.closeNode()},parseOpen:function(a){if(this.parser)return this.parser.xform.parseOpen(a),!0;switch(a.name){case this.tag:return this.model={},!0;default:if(this.parser=this.map[a.name],this.parser)return this.parser.xform.parseOpen(a),!0}return!1},parseText:function(a){this.parser&&this.parser.xform.parseText(a)},parseClose:function(a){return!!this.parser&&(this.parser.xform.parseClose(a)||(this.model[this.parser.name]=this.parser.xform.model,this.parser=void 0),!0)},reconcile:function(a,b){this.children.forEach(function(c){c.xform.prepare(a[c.tag],b)})}});