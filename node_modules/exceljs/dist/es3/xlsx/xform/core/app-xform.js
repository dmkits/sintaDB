/*! ExcelJS 28-04-2017 */
"use strict";var utils=require("../../../utils/utils"),XmlStream=require("../../../utils/xml-stream"),BaseXform=require("../base-xform"),StringXform=require("../simple/string-xform"),AppHeadingPairsXform=require("./app-heading-pairs-xform"),AppTitleOfPartsXform=require("./app-titles-of-parts-xform"),props={company:"Company",manager:"Manager",worksheets:[{name:"sheet1"}]},AppXform=module.exports=function(){this.map={Company:new StringXform({tag:"Company"}),Manager:new StringXform({tag:"Manager"}),HeadingPairs:new AppHeadingPairsXform,TitleOfParts:new AppTitleOfPartsXform}};AppXform.DateFormat=function(a){return a.toISOString().replace(/\.\d{3}/,"")},AppXform.DateAttrs={"xsi:type":"dcterms:W3CDTF"},AppXform.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},utils.inherits(AppXform,BaseXform,{render:function(a,b){a.openXml(XmlStream.StdDocAttributes),a.openNode("Properties",AppXform.PROPERTY_ATTRIBUTES),a.leafNode("Application",void 0,"Microsoft Excel"),a.leafNode("DocSecurity",void 0,"0"),a.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(a,b.worksheets),this.map.TitleOfParts.render(a,b.worksheets),this.map.Company.render(a,b.company||""),this.map.Manager.render(a,b.manager),a.leafNode("LinksUpToDate",void 0,"false"),a.leafNode("SharedDoc",void 0,"false"),a.leafNode("HyperlinksChanged",void 0,"false"),a.leafNode("AppVersion",void 0,"16.0300"),a.closeNode()},parseOpen:function(a){if(this.parser)return this.parser.parseOpen(a),!0;switch(a.name){case"Properties":return!0;default:return this.parser=this.map[a.name],!!this.parser&&(this.parser.parseOpen(a),!0)}},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){if(this.parser)return this.parser.parseClose(a)||(this.parser=void 0),!0;switch(a){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}});