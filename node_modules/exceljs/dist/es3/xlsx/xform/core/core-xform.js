/*! ExcelJS 28-04-2017 */
"use strict";var utils=require("../../../utils/utils"),XmlStream=require("../../../utils/xml-stream"),BaseXform=require("../base-xform"),DateXform=require("../simple/date-xform"),StringXform=require("../simple/string-xform"),CoreXform=module.exports=function(){this.map={"dc:creator":new StringXform({tag:"dc:creator"}),"dc:title":new StringXform({tag:"dc:title"}),"dc:subject":new StringXform({tag:"dc:subject"}),"dc:description":new StringXform({tag:"dc:description"}),"dc:identifier":new StringXform({tag:"dc:identifier"}),"dc:language":new StringXform({tag:"dc:language"}),"cp:keywords":new StringXform({tag:"cp:keywords"}),"cp:category":new StringXform({tag:"cp:category"}),"cp:lastModifiedBy":new StringXform({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new DateXform({tag:"cp:lastPrinted",format:CoreXform.DateFormat}),"cp:revision":new DateXform({tag:"cp:revision"}),"cp:contentStatus":new StringXform({tag:"cp:contentStatus"}),"dcterms:created":new DateXform({tag:"dcterms:created",attrs:CoreXform.DateAttrs,format:CoreXform.DateFormat}),"dcterms:modified":new DateXform({tag:"dcterms:modified",attrs:CoreXform.DateAttrs,format:CoreXform.DateFormat})}};CoreXform.DateFormat=function(a){return a.toISOString().replace(/\.\d{3}/,"")},CoreXform.DateAttrs={"xsi:type":"dcterms:W3CDTF"},CoreXform.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},utils.inherits(CoreXform,BaseXform,{render:function(a,b){a.openXml(XmlStream.StdDocAttributes),a.openNode("cp:coreProperties",CoreXform.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(a,b.creator),this.map["dc:title"].render(a,b.title),this.map["dc:subject"].render(a,b.subject),this.map["dc:description"].render(a,b.description),this.map["dc:identifier"].render(a,b.identifier),this.map["dc:language"].render(a,b.language),this.map["cp:keywords"].render(a,b.keywords),this.map["cp:category"].render(a,b.category),this.map["cp:lastModifiedBy"].render(a,b.lastModifiedBy),this.map["cp:lastPrinted"].render(a,b.lastPrinted),this.map["cp:revision"].render(a,b.revision),this.map["cp:contentStatus"].render(a,b.contentStatus),this.map["dcterms:created"].render(a,b.created),this.map["dcterms:modified"].render(a,b.modified),a.closeNode()},parseOpen:function(a){if(this.parser)return this.parser.parseOpen(a),!0;switch(a.name){case"cp:coreProperties":return!0;default:if(this.parser=this.map[a.name],this.parser)return this.parser.parseOpen(a),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(a))}},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){if(this.parser)return this.parser.parseClose(a)||(this.parser=void 0),!0;switch(a){case"cp:coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+a)}}});