/*! ExcelJS 28-04-2017 */
"use strict";var utils=require("../../utils/utils"),BaseXform=require("./base-xform"),ListXform=module.exports=function(a){this.tag=a.tag,this.count=a.count,this.empty=a.empty,this.$count=a.$count||"count",this.$=a.$,this.childXform=a.childXform};utils.inherits(ListXform,BaseXform,{prepare:function(a,b){var c=this.childXform;a&&a.forEach(function(a){c.prepare(a,b)})},render:function(a,b){if(b&&b.length){a.openNode(this.tag,this.$),this.count&&a.addAttribute(this.$count,b.length);var c=this.childXform;b.forEach(function(b){c.render(a,b)}),a.closeNode()}else this.empty&&a.leafNode(this.tag)},parseOpen:function(a){if(this.parser)return this.parser.parseOpen(a),!0;switch(a.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(a)&&(this.parser=this.childXform,!0)}},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){return!!this.parser&&(this.parser.parseClose(a)||(this.model.push(this.parser.model),this.parser=void 0),!0)},reconcile:function(a,b){if(a){var c=this.childXform;a.forEach(function(a){c.reconcile(a,b)})}}});