/*! ExcelJS 28-04-2017 */
"use strict";var TextXform=require("./text-xform"),FontXform=require("../style/font-xform"),utils=require("../../../utils/utils"),BaseXform=require("../base-xform"),RichTextXform=module.exports=function(a){this.model=a};RichTextXform.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},utils.inherits(RichTextXform,BaseXform,{get tag(){return"r"},get textXform(){return this._textXform||(this._textXform=new TextXform)},get fontXform(){return this._fontXform||(this._fontXform=new FontXform(RichTextXform.FONT_OPTIONS))},render:function(a,b){b=b||this.model,a.openNode("r"),b.font&&this.fontXform.render(a,b.font),this.textXform.render(a,b.text),a.closeNode()},parseOpen:function(a){if(this.parser)return this.parser.parseOpen(a),!0;switch(a.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(a),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(a),!0;default:return!1}},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){switch(a){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(a),!0}}});