/*! ExcelJS 28-04-2017 */
"use strict";var TextXform=require("./text-xform"),RichTextXform=require("./rich-text-xform"),utils=require("../../../utils/utils"),BaseXform=require("../base-xform"),PhoneticTextXform=module.exports=function(){this.map={r:new RichTextXform,t:new TextXform}};utils.inherits(PhoneticTextXform,BaseXform,{get tag(){return"rPh"},render:function(a,b){if(a.openNode(this.tag,{sb:b.sb||0,eb:b.eb||0}),b&&b.hasOwnProperty("richText")&&b.richText){var c=this.map.r;b.richText.forEach(function(b){c.render(a,b)})}else b&&this.map.t.render(a,b.text);a.closeNode()},parseOpen:function(a){var b=a.name;return this.parser?(this.parser.parseOpen(a),!0):b!==this.tag?(this.parser=this.map[b],!!this.parser&&(this.parser.parseOpen(a),!0)):void(this.model={sb:parseInt(a.attributes.sb,10),eb:parseInt(a.attributes.eb,10)})},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){if(this.parser){if(!this.parser.parseClose(a)){switch(a){case"r":var b=this.model.richText;b||(b=this.model.richText=[]),b.push(this.parser.model);break;case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(a){case this.tag:return!1;default:return!0}}});