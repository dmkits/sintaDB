/*! ExcelJS 28-04-2017 */
"use strict";var TextXform=require("./text-xform"),RichTextXform=require("./rich-text-xform"),PhoneticTextXform=require("./phonetic-text-xform"),utils=require("../../../utils/utils"),BaseXform=require("../base-xform"),SharedStringXform=module.exports=function(a){this.model=a,this.map={r:new RichTextXform,t:new TextXform,rPh:new PhoneticTextXform}};utils.inherits(SharedStringXform,BaseXform,{get tag(){return"si"},render:function(a,b){if(a.openNode(this.tag),b&&b.hasOwnProperty("richText")&&b.richText){var c=this.map.r;b.richText.forEach(function(b){c.render(a,b)})}else void 0!==b&&null!==b&&this.map.t.render(a,b);a.closeNode()},parseOpen:function(a){var b=a.name;return this.parser?(this.parser.parseOpen(a),!0):b===this.tag?(this.model={},!0):(this.parser=this.map[b],!!this.parser&&(this.parser.parseOpen(a),!0))},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){if(this.parser){if(!this.parser.parseClose(a)){switch(a){case"r":var b=this.model.richText;b||(b=this.model.richText=[]),b.push(this.parser.model);break;case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(a){case this.tag:return!1;default:return!0}}});