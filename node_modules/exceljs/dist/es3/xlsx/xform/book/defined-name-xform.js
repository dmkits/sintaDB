/*! ExcelJS 28-04-2017 */
"use strict";function extractRanges(a){var b=[],c=!1,d="";return a.split(",").forEach(function(a){if(a){var e=(a.match(/'/g)||[]).length;if(!e)return void(c?d+=a+",":b.push(a));var f=e%2===0;!c&&f?b.push(a):c&&!f?(c=!1,b.push(d+a),d=""):(c=!0,d+=a+",")}}),b}var utils=require("../../../utils/utils"),BaseXform=require("../base-xform"),DefinedNamesXform=module.exports=function(){};utils.inherits(DefinedNamesXform,BaseXform,{render:function(a,b){a.openNode("definedName",{name:b.name,localSheetId:b.localSheetId}),a.writeText(b.ranges.join(",")),a.closeNode()},parseOpen:function(a){switch(a.name){case"definedName":return this._parsedName=a.attributes.name,this._parsedLocalSheetId=a.attributes.localSheetId,this._parsedText=[],!0;default:return!1}},parseText:function(a){this._parsedText.push(a)},parseClose:function(){return this.model={name:this._parsedName,ranges:extractRanges(this._parsedText.join(""))},void 0!==this._parsedLocalSheetId&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}});