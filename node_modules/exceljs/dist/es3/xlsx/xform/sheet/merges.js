/*! ExcelJS 28-04-2017 */
"use strict";var _=require("../../../utils/under-dash"),Range=require("../../../doc/range"),colCache=require("../../../utils/col-cache"),Enums=require("../../../doc/enums");(module.exports=function(){this.merges={}}).prototype={add:function(a){if(this.merges[a.master])this.merges[a.master].expandToAddress(a.address);else{var b=a.master+":"+a.address;this.merges[a.master]=new Range(b)}},get mergeCells(){return _.map(this.merges,function(a){return a.range})},reconcile:function(a,b){_.each(a,function(a){for(var c=colCache.decode(a),d=c.top;d<=c.bottom;d++)for(var e=b[d-1],f=c.left;f<=c.right;f++){var g=e.cells[f-1];g?g.type===Enums.ValueType.Merge&&(g.master=c.tl):e.cells[f]={type:Enums.ValueType.Null,address:colCache.encodeAddress(d,f)}}})},getMasterAddress:function(a){var b=this.hash[a];if(b)return b.tl}};