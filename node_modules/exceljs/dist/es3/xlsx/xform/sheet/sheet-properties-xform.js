/*! ExcelJS 28-04-2017 */
"use strict";var utils=require("../../../utils/utils"),BaseXform=require("../base-xform"),ColorXform=require("../style/color-xform"),PageSetupPropertiesXform=require("./page-setup-properties-xform"),SheetPropertiesXform=module.exports=function(){this.map={tabColor:new ColorXform("tabColor"),pageSetUpPr:new PageSetupPropertiesXform}};utils.inherits(SheetPropertiesXform,BaseXform,{get tag(){return"sheetPr"},render:function(a,b){if(b){a.addRollback(),a.openNode("sheetPr");var c=!1;c=this.map.tabColor.render(a,b.tabColor)||c,c=this.map.pageSetUpPr.render(a,b.pageSetup)||c,c?(a.closeNode(),a.commit()):a.rollback()}},parseOpen:function(a){return this.parser?(this.parser.parseOpen(a),!0):a.name===this.tag?(this.map.tabColor.reset(),this.map.pageSetUpPr.reset(),!0):!!this.map[a.name]&&(this.parser=this.map[a.name],this.parser.parseOpen(a),!0)},parseText:function(a){if(this.parser)return this.parser.parseText(a),!0},parseClose:function(a){return this.parser?(this.parser.parseClose(a)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model)):this.model=null,!1)}});