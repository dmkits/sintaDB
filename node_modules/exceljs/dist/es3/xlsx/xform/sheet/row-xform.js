/*! ExcelJS 28-04-2017 */
"use strict";var utils=require("../../../utils/utils"),BaseXform=require("../base-xform"),CellXform=require("./cell-xform"),RowXform=module.exports=function(){this.map={c:new CellXform}};utils.inherits(RowXform,BaseXform,{get tag(){return"row"},prepare:function(a,b){var c=b.styles.addStyleModel(a.style);c&&(a.styleId=c);var d=this.map.c;a.cells.forEach(function(a){d.prepare(a,b)})},render:function(a,b,c){a.openNode("row"),a.addAttribute("r",b.number),b.height&&(a.addAttribute("ht",b.height),a.addAttribute("customHeight","1")),b.hidden&&a.addAttribute("hidden","1"),b.min>0&&b.max>0&&b.min<=b.max&&a.addAttribute("spans",b.min+":"+b.max),b.styleId&&(a.addAttribute("s",b.styleId),a.addAttribute("customFormat","1")),a.addAttribute("x14ac:dyDescent","0.25"),b.outlineLevel&&a.addAttribute("outlineLevel",b.outlineLevel),b.collapsed&&a.addAttribute("collapsed","1");var d=this.map.c;b.cells.forEach(function(b){d.render(a,b,c)}),a.closeNode()},parseOpen:function(a){if(this.parser)return this.parser.parseOpen(a),!0;if("row"===a.name){var b=a.attributes.spans?a.attributes.spans.split(":").map(function(a){return parseInt(a,10)}):[void 0,void 0],c=this.model={number:parseInt(a.attributes.r,10),min:b[0],max:b[1],cells:[]};return a.attributes.s&&(c.styleId=parseInt(a.attributes.s,10)),a.attributes.hidden&&(c.hidden=!0),a.attributes.bestFit&&(c.bestFit=!0),a.attributes.ht&&(c.height=parseFloat(a.attributes.ht)),a.attributes.outlineLevel&&(c.outlineLevel=parseInt(a.attributes.outlineLevel,10)),a.attributes.collapsed&&(c.collapsed=!0),!0}return this.parser=this.map[a.name],!!this.parser&&(this.parser.parseOpen(a),!0)},parseText:function(a){this.parser&&this.parser.parseText(a)},parseClose:function(a){return!!this.parser&&(this.parser.parseClose(a)||(this.model.cells.push(this.parser.model),this.parser=void 0),!0)},reconcile:function(a,b){a.style=a.styleId?b.styles.getStyleModel(a.styleId):{},void 0!==a.styleId&&(a.styleId=void 0);var c=this.map.c;a.cells.forEach(function(a){c.reconcile(a,b)})}});