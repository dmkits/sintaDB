/*! ExcelJS 28-04-2017 */
"use strict";var Worksheet=require("./worksheet"),DefinedNames=require("./defined-names"),XLSX=require("./../xlsx/xlsx"),CSV=require("./../csv/csv");(module.exports=function(){this.created=new Date,this.modified=this.created,this.properties={},this._worksheets=[],this.views=[],this._definedNames=new DefinedNames}).prototype={get xlsx(){return this._xlsx||(this._xlsx=new XLSX(this))},get csv(){return this._csv||(this._csv=new CSV(this))},get nextId(){var a;for(a=1;a<this._worksheets.length;a++)if(!this._worksheets[a])return a;return this._worksheets.length||1},addWorksheet:function(a,b){var c=this.nextId;a=a||"sheet"+c,b&&("string"==typeof b?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),b={properties:{tabColor:{argb:b}}}):(b.argb||b.theme||b.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),b={properties:{tabColor:b}}));var d=Object.assign({},b,{id:c,name:a,workbook:this}),e=new Worksheet(d);return this._worksheets[c]=e,e},_removeWorksheet:function(a){delete this._worksheets[a.id]},removeWorksheet:function(a){var b=this.getWorksheet(a);b&&b.destroy()},getWorksheet:function(a){return void 0===a?this._worksheets.find(function(a){return a}):"number"==typeof a?this._worksheets[a]:"string"==typeof a?this._worksheets.find(function(b){return b&&b.name===a}):void 0},get worksheets(){return this._worksheets.filter(Boolean)},eachSheet:function(a){this._worksheets.forEach(function(b){a(b,b.id)})},get definedNames(){return this._definedNames},clearThemes:function(){this._themes=void 0},get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this._worksheets.filter(Boolean).map(function(a){return a.model}),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes}},set model(a){var b=this;this.creator=a.creator,this.lastModifiedBy=a.lastModifiedBy,this.lastPrinted=a.lastPrinted,this.created=a.created,this.modified=a.modified,this.company=a.company,this.manager=a.manager,this.title=a.title,this.subject=a.subject,this.keywords=a.keywords,this.category=a.category,this.description=a.description,this.language=a.language,this.revision=a.revision,this.contentStatus=a.contentStatus,this.properties=a.properties,this._worksheets=[],a.worksheets.forEach(function(a){var c=a.id,d=a.name;(b._worksheets[c]=new Worksheet({id:c,name:d,workbook:b})).model=a}),this._definedNames.model=a.definedNames,this.views=a.views,this._themes=a.themes}};