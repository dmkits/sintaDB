/*! ExcelJS 28-04-2017 */
"use strict";var colCache=require("./../utils/col-cache"),Range=module.exports=function(){this.decode(arguments)};Range.prototype={_set_tlbr:function(a,b,c,d,e){this.model={top:Math.min(a,c),left:Math.min(b,d),bottom:Math.max(a,c),right:Math.max(b,d),sheetName:e}},_set_tl_br:function(a,b,c){a=colCache.decodeAddress(a),b=colCache.decodeAddress(b),this._set_tlbr(a.row,a.col,b.row,b.col,c)},decode:function(a){switch(a.length){case 5:this._set_tlbr(a[0],a[1],a[2],a[3],a[4]);break;case 4:this._set_tlbr(a[0],a[1],a[2],a[3]);break;case 3:this._set_tl_br(a[0],a[1],a[2]);break;case 2:this._set_tl_br(a[0],a[1]);break;case 1:var b=a[0];if(b instanceof Range)this.model={top:b.model.top,left:b.model.left,bottom:b.model.bottom,right:b.model.right,sheetName:b.sheetName};else if(b instanceof Array)this.decode(b);else if(b.top&&b.left&&b.bottom&&b.right)this.model={top:b.top,left:b.left,bottom:b.bottom,right:b.right,sheetName:b.sheetName};else{var c=colCache.decodeEx(b);c.top?this.model={top:c.top,left:c.left,bottom:c.bottom,right:c.right,sheetName:c.sheetName}:this.model={top:c.row,left:c.col,bottom:c.row,right:c.col,sheetName:c.sheetName}}break;case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+a.length)}},get top(){return this.model.top||1},set top(a){this.model.top=a},get left(){return this.model.left||1},set left(a){this.model.left=a},get bottom(){return this.model.bottom||1},set bottom(a){this.model.bottom=a},get right(){return this.model.right||1},set right(a){this.model.right=a},get sheetName(){return this.model.sheetName},set sheetName(a){this.model.sheetName=a},get _serialisedSheetName(){var a=this.model.sheetName;return a?/^[a-zA-Z0-9]*$/.test(a)?a+"!":"'"+a+"'!":""},expand:function(a,b,c,d){(!this.model.top||a<this.top)&&(this.top=a),(!this.model.left||b<this.left)&&(this.left=b),(!this.model.bottom||c>this.bottom)&&(this.bottom=c),(!this.model.right||d>this.right)&&(this.right=d)},expandRow:function(a){if(a){var b=a.dimensions;b&&this.expand(a.number,b.min,a.number,b.max)}},expandToAddress:function(a){var b=colCache.decodeEx(a);this.expand(b.row,b.col,b.row,b.col)},get tl(){return colCache.n2l(this.left)+this.top},get $t$l(){return"$"+colCache.n2l(this.left)+"$"+this.top},get br(){return colCache.n2l(this.right)+this.bottom},get $b$r(){return"$"+colCache.n2l(this.right)+"$"+this.bottom},get range(){return this._serialisedSheetName+this.tl+":"+this.br},get $range(){return this._serialisedSheetName+this.$t$l+":"+this.$b$r},get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl},get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l},get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)},toString:function(){return this.range},intersects:function(a){return(!a.sheetName||!this.sheetName||a.sheetName===this.sheetName)&&(!(a.bottom<this.top)&&(!(a.top>this.bottom)&&(!(a.right<this.left)&&!(a.left>this.right))))},contains:function(a){var b=colCache.decodeEx(a);return this.containsEx(b)},containsEx:function(a){return(!a.sheetName||!this.sheetName||a.sheetName===this.sheetName)&&(a.row>=this.top&&a.row<=this.bottom&&a.col>=this.left&&a.col<=this.right)}};