/*! ExcelJS 28-04-2017 */
"use strict";var events=require("events"),utils=require("../utils/utils"),LineBuffer=module.exports=function(a){events.EventEmitter.call(this),this.encoding=a.encoding,this.buffer=null,this.corked=!1,this.queue=[]};utils.inherits(LineBuffer,events.EventEmitter,{write:function(a,b,c){var d=this.buffer?this.buffer+a:a,e=d.split(/\r?\n/g);return this.buffer=e.pop(),e.forEach(function(a){this.corked?this.queue.push(a):this.emit("line",a)}),!this.corked},cork:function(){this.corked=!0},uncork:function(){this.corked=!1,this._flush(),this.emit("drain")},setDefaultEncoding:function(a){},end:function(a,b,c){this.buffer&&(this.emit("line",this.buffer),this.buffer=null),this.emit("done")},_flush:function(){this.corked||(this.queue.forEach(function(a){this.emit("line",a)}),this.queue=[])}});