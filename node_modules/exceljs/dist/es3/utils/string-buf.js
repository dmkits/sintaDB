/*! ExcelJS 28-04-2017 */
"use strict";var utils=require("./utils");(module.exports=function(a){this._buf=new Buffer(a&&a.size||16384),this._encoding=a&&a.encoding||"utf8",this._inPos=0,this._buffer=void 0}).prototype={get length(){return this._inPos},get capacity(){return this._buf.length},get buffer(){return this._buf},toBuffer:function(){return this._buffer||(this._buffer=new Buffer(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer},reset:function(a){a=a||0,this._buffer=void 0,this._inPos=a},_grow:function(a){for(var b=2*this._buf.length;b<a;)b*=2;var c=new Buffer(b);this._buf.copy(c,0),this._buf=c},addText:function(a){this._buffer=void 0;for(var b=this._inPos+this._buf.write(a,this._inPos,this._encoding);b>=this._buf.length-4;)this._grow(this._inPos+a.length),b=this._inPos+this._buf.write(a,this._inPos,this._encoding);this._inPos=b},addStringBuf:function(a){a.length&&(this._buffer=void 0,this.length+a.length>this.capacity&&this._grow(this.length+a.length),a._buf.copy(this._buf,this._inPos,0,a.length),this._inPos+=a.length)}};