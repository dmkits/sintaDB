/*! ExcelJS 28-04-2017 */
"use strict";var events=require("events"),utils=require("./utils"),StutteredPipe=module.exports=function(a,b,c){var d=this;c=c||{},this.readable=a,this.writable=b,this.bufSize=c.bufSize||16384,this.autoPause=c.autoPause||!1,this.paused=!1,this.eod=!1,this.scheduled=null,a.on("end",function(){d.eod=!0,b.end()}),a.on("readable",function(){d.paused||d.resume()}),this._schedule()};utils.inherits(StutteredPipe,events.EventEmitter,{pause:function(){this.paused=!0},resume:function(){this.eod||(null!==this.scheduled&&clearImmediate(this.scheduled),this._schedule())},_schedule:function(){var a=this;this.scheduled=setImmediate(function(){if(a.scheduled=null,!a.eod&&!a.paused){var b=a.readable.read(a.bufSize);b&&b.length?(a.writable.write(b),a.paused||a.autoPause||a._schedule()):a.paused||a._schedule()}})}});