/*! ExcelJS 28-04-2017 */
"use strict";var colCache=require("./col-cache"),cellRefRegex=/(([a-z_\-0-9]*)!)?\$?([a-z]+)\$?([1-9][0-9]*)/i,replacementCandidateRx=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})(\()?/gi,CRrx=/^(\$)?([a-z]+)(\$)?([1-9][0-9]*)$/i,slideFormula=function(a,b,c){var d=colCache.decode(b),e=colCache.decode(c);return a.replace(replacementCandidateRx,function(a,b,c,f,g){if(g)return a;var h=CRrx.exec(f);if(h){var i=h[1],j=h[2].toUpperCase(),k=h[3],l=h[4];if(j.length>3||3===j.length&&j>"XFD")return a;var m=colCache.l2n(j),n=parseInt(l,10);i||(m+=e.col-d.col),k||(n+=e.row-d.row);return(b||"")+(i||"")+colCache.n2l(m)+(k||"")+n}return a})};module.exports={slideFormula:slideFormula};