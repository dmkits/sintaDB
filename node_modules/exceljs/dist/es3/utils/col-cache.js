/*! ExcelJS 28-04-2017 */
"use strict";var colCache=module.exports={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2n:{},_n2l:[],_level:function(a){return a<=26?1:a<=676?2:3},_fill:function(a){var b,c,d,e,f,g=1;if(a>=1)for(;g<=26;)b=this._dictionary[g-1],this._n2l[g]=b,this._l2n[b]=g,g++;if(a>=2)for(;g<=702;)c=g-27,d=c%26,e=Math.floor(c/26),b=this._dictionary[e]+this._dictionary[d],this._n2l[g]=b,this._l2n[b]=g,g++;if(a>=3)for(;g<=16384;)c=g-703,d=c%26,e=Math.floor(c/26)%26,f=Math.floor(c/676),b=this._dictionary[f]+this._dictionary[e]+this._dictionary[d],this._n2l[g]=b,this._l2n[b]=g,g++},l2n:function(a){if(this._l2n[a]||this._fill(a.length),!this._l2n[a])throw new Error("Out of bounds. Invalid column letter: "+a);return this._l2n[a]},n2l:function(a){if(a<1||a>16384)throw new Error(""+a+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[a]||this._fill(this._level(a)),this._n2l[a]},_hash:{},validateAddress:function(a){if(!a.match(/^[A-Z]+\d+$/))throw new Error("Invalid Address: "+a);return!0},decodeAddress:function(a){var b=this._hash[a];if(b)return b;var c=a.match(/[A-Z]+/)[0],d=this.l2n(c),e=a.match(/\d+/)[0],f=parseInt(e,10);a=c+e;var g={address:a,col:d,row:f,$col$row:"$"+c+"$"+e};return d<=100&&f<=100&&(this._hash[a]=g,this._hash[g.$col$row]=g),g},getAddress:function(a,b){if(b){var c=this.n2l(b)+a;return this.decodeAddress(c)}return this.decodeAddress(a)},decode:function(a){var b=a.split(":");if(2===b.length){var c=this.decodeAddress(b[0]),d=this.decodeAddress(b[1]),e={top:Math.min(c.row,d.row),left:Math.min(c.col,d.col),bottom:Math.max(c.row,d.row),right:Math.max(c.col,d.col)};return e.tl=this.n2l(e.left)+e.top,e.br=this.n2l(e.right)+e.bottom,e.dimensions=e.tl+":"+e.br,e}return this.decodeAddress(a)},decodeEx:function(a){var b=a.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ ^!]*))!)?(.*)/),c=b[1]||b[2],d=b[3],e=d.split(":");if(e.length>1){var f=this.decodeAddress(e[0]),g=this.decodeAddress(e[1]),h=Math.min(f.row,g.row),i=Math.min(f.col,g.col),j=Math.max(f.row,g.row),k=Math.max(f.col,g.col);return f=this.n2l(i)+h,g=this.n2l(k)+j,{top:h,left:i,bottom:j,right:k,sheetName:c,tl:{address:f,col:i,row:h,$col$row:"$"+this.n2l(i)+"$"+h,sheetName:c},br:{address:g,col:k,row:j,$col$row:"$"+this.n2l(k)+"$"+j,sheetName:c},dimensions:f+":"+g}}if(d.startsWith("#"))return c?{sheetName:c,error:d}:{error:d};var l=this.decodeAddress(d);return c?Object.assign({sheetName:c},l):l},encodeAddress:function(a,b){return colCache.n2l(b)+a},encode:function(){switch(arguments.length){case 2:return colCache.encodeAddress(arguments[0],arguments[1]);case 4:return colCache.encodeAddress(arguments[0],arguments[1])+":"+colCache.encodeAddress(arguments[2],arguments[3]);default:throw new Error("Can only encode with 2 or 4 arguments")}}};