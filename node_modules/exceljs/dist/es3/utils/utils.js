/*! ExcelJS 28-04-2017 */
"use strict";var fs=require("fs"),PromishLib=require("./promish"),inherits=function(a,b,c,d){if(a.super_=b,d||(d=c,c=null),c)for(var e in c)Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(c,e));var f={constructor:{value:a,enumerable:!1,writable:!1,configurable:!0}};if(d)for(var e in d)f[e]=Object.getOwnPropertyDescriptor(d,e);a.prototype=Object.create(b.prototype,f)},utils=module.exports={nop:function(){},promiseImmediate:function(a){return new PromishLib.Promish(function(b,c){global.setImmediate?setImmediate(function(){b(a)}):setTimeout(function(){b(a)},1)})},inherits:inherits,dateToExcel:function(a,b){return 25569+a.getTime()/864e5-(b?1462:0)},excelToDate:function(a,b){return new Date(24*(a-25569+(b?1462:0))*3600*1e3)},parsePath:function(a){var b=a.lastIndexOf("/");return{path:a.substring(0,b),name:a.substring(b+1)}},getRelsPath:function(a){var b=utils.parsePath(a);return b.path+"/_rels/"+b.name+".rels"},xmlEncode:function(a){return a.replace(/[<>&'"\x7F\x00-\x08\x0A-\x0C\x0E-\x1F]/g,function(a){switch(a){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;";default:return""}})},xmlDecode:function(a){return a.replace(/&([a-z]*);/,function(a){switch(a){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return a}})},validInt:function(a){var b=parseInt(a,10);return isNaN(b)?0:b},isDateFmt:function(a){return!!a&&(a=a.replace(/[\[][^\]]*[\]]/g,""),a=a.replace(/"[^"]*"/g,""),null!==a.match(/[ymdhMsb]+/))},fs:{exists:function(a){return new PromishLib.Promish(function(b,c){fs.exists(a,function(a){b(a)})})}},toIsoDateString:function(a){return a.toIsoString().subsstr(0,10)}};